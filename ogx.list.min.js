/* globules.io OGX.List 1.2.5 */
if(typeof OGX==="undefined"){var OGX={}}OGX.List=function(){if(typeof moment==="undefined"){console.log("Error: moment.js not found!");return}var filteringMode="and";var filterCount=0;var indexes=false;if(arguments.length===1&&arguments[0]instanceof Array){arguments=arguments[0]}var array=Object.create(Array.prototype);array=Array.apply(array,arguments)||array;for(var method in OGX.List.prototype){if(OGX.List.prototype.hasOwnProperty(method)){array[method]=OGX.List.prototype[method]}}array.insert=function(e,t){if(typeof t==="undefined"){array.push(e)}else{array.splice(t,0,e)}if(indexes){addToCache(e)}return true};array.delete=function(e){var t=this;var r=array.splice(e,1);if(r.length){if(indexes){var a=matchesCache(r[0]);if(a){setTimeout(function(){t.rebuild(a)},0)}}return r[0]}return false};array.last=function(){if(this.length){return this[this.length-1]}return};array.findDelete=function(e,t,r){var a=0;if(typeof r==="undefined"){r=0}var i=new OGX.List;for(var s=0;s<this.length;s++){if(this[s][e]===t){i.push(this.splice(s,1)[0]);if(indexes){var f=matchesCache(i.last());if(f){this.rebuild(f)}}a++;if(r>0&&r===a){if(r===1){return i[0]}else{return i}}s--}}return i};array.findReplace=function(e,t,r,a){var i=0;if(typeof a==="undefined"){a=0}var s=new OGX.List;for(var f=0;f<this.length;f++){if(this[f][e]===t){s.push(this[f]);i++;this[f]=r;if(a>0&&a===i){if(a===1){return s[0]}else{return s}}}}if(!s.length){return false}else{return s}};array.findUpdate=function(e,t,r,a,i){var s=0;if(typeof a==="undefined"){a=false}if(typeof i==="undefined"){i=0}var f=new OGX.List;var n;for(var o=0;o<this.length;o++){if(this[o][e]===t){n=false;for(var l in r){if(a){if(this[o].hasOwnProperty(l)){this[o][l]=r[l];n=true;s++}}else{this[o][l]=r[l];n=true;s++}}if(n){f.push(this[o]);if(i>0&&i===s){if(i===1){return f[0]}else{return f}}}}}if(!f.length){return false}else{return f}};array.findIndex=function(e,t){var r=false;if(t instanceof RegExp){r=true}for(var a=0;a<this.length;a++){if(r){if(this[a][e].match(t)){return{index:a}}}else{if(this[a][e]===t){return{index:a}}}}return false};array.find=function(e,t,r){var a=0;var i=new OGX.List;var s=false;if(t instanceof RegExp){s=true}if(typeof r==="undefined"){r=0}for(var f=0;f<this.length;f++){if(s){if(this[f][e].match(t)){i.push(this[f]);a++}}else{if(this[f][e]===t){i.push(this[f]);a++}}if(r>0&&a===r){if(r===1){return i[0]}else{return i}}}if(!i.length){return false}else{return i}};array.swap=function(e,t){var r=this[e];this[e]=this[t];this[t]=r};array.cache=function(){if(!indexes){indexes={}}var e=[];var t=[];var r;if(arguments.length>1){for(var a=0;a<arguments.length;a++){e.push(arguments[a])}e=e.join("|")}else{e=arguments[0]}if(!indexes.hasOwnProperty(e)){indexes[e]={}}for(var i=0;i<this.length;i++){t=[];for(var a=0;a<arguments.length;a++){t.push(this[i][arguments[a]])}t=t.join("|");if(!indexes[e].hasOwnProperty(t)){indexes[e][t]=[]}indexes[e][t].push(this[i])}return true};array.uncache=function(e){if(!indexes){return false}var t=e;if(arguments.length>1){t=arguments.join("|")}if(indexes.hasOwnProperty(t)){delete indexes[t];return true}return false};function addToCache(e){var t;for(var r in indexes){if(r.indexOf("|")!==-1){r=r.split("|");t=[];for(var a=0;a<r.length;a++){if(e.hasOwnProperty(r[a])){t.push(e[r[a]])}}t=t.join("|");r=r.join("|")}else{if(e.hasOwnProperty(r)){t=e[r]}}if(!indexes.hasOwnProperty(r)){indexes[r]={}}indexes[r][t]=e}}array.rebuild=function(e){for(var t=0;t<e.length;t++){delete indexes[e[t]];this.cache(e[t])}};function matchesCache(e){var t=[];var r=[];var a;for(var i in indexes){a=true;if(i.indexOf("|")!==-1){t=i.split("|")}else{t=[i]}for(var s=0;s<t.length;s++){if(!e.hasOwnProperty(t[s])){a=false;break}}if(a){r.push(i)}}if(r.length){return r}return false}array.read=function(e,t,r){var a=arguments;if(!indexes){return false}if(!a.length){return indexes}var i,s;if(typeof e==="object"){r=a[1];i=[];s=[];for(var f in e){i.push(f);s.push(e[f])}i=i.join("|");s=s.join("|")}else{i=e;s=t}if(typeof r==="undefined"){r=0}if(indexes.hasOwnProperty(i)&&indexes[i].hasOwnProperty(s)){if(r){if(r>1){return indexes[i][s].splice(0,r)}else{return indexes[i][s][0]}}return indexes[i][s]}return false};array.clear=function(){indexes=false;filterCount=0;this.length=0};array.unique=function(e,t,r){if(typeof t==="undefined"){t=true}if(typeof r==="undefined"){r=[e]}else{if(!Array.isArray(r)){r=[r]}}var a={};a[e]={regex:/(.){1,}/};var i=this.get();var s=[];var f=new OGX.List;var n;for(var o=0;o<i.length;o++){if(s.indexOf(i[o][e])===-1){s.push(i[o][e]);if(t){n={};for(var l=0;l<r.length;l++){n[r[l]]=i[o][e]}f.push(n)}}}if(t){return f}return s};array.order=function(e,t){array.sort(dynamicSort(e,t))};function dynamicSort(r,a){return function(e,t){return e[r]<t[r]?a*-1:e[r]>t[r]?a:0}}array.group=function(e,t,r){if(Array.isArray(e)){return array.groupm(e,t,r)}var a;var i={};for(var s=0;s<this.length;s++){a=extract(this[s],e,t,r);if(a){a=a.split(".").pop();if(!i.hasOwnProperty(a)){i[a]=new OGX.List}i[a].push(this[s])}}return i};array.groupm=function(n,o,l){function h(e,t){var r=new OGX.List(e);var a=o;var i=l;if(typeof o!=="undefined"){Array.isArray(o)?a=o[t]:null}if(typeof l!=="undefined"){Array.isArray(l)?i=l[t]:null}var s=r.group(n[t],a,i);if(t+1<=n.length-1){for(var f in s){s[f]=h(s[f],t+1)}}return s}var e=h(this,0);return e};function extract(__item,__by,__mode,__param){var data;try{data=eval("__item."+__by)}catch(e){}if(data){switch(__mode){case"substr":data=data.substr(__param[0],__param[1]);return data;case"numrange":data=Number(data);if(!Array.isArray(__param)){data=Math.floor(data/__param);data=data*__param+" - "+(data+1)*__param}else{data=Math.floor(data/__param[0]);if(__param[2]==="pre"){data=__param[1]+data*__param[0]+" - "+__param[1]+(data+1)*__param[0]}else{data=data*__param[0]+__param[1]+" - "+(data+1)*__param[0]+__param[1]}}return data;case"date":if(!Array.isArray(__param)){if(__param==="year"){data=data.substr(0,4);return data}else{if(__param==="month"){data=data.substr(0,7);return data}else{if(__param==="week"){data=data.substr(0,4)+" week "+moment(data).week();return data}}}}data=moment(data).unix();data=Math.floor(data/(__param[0]*60*60*24));data=data*(__param[0]*60*60*24);data=moment(data*1e3).format(__param[1])+" - "+moment(data*1e3+__param[0]*1e3*60*60*24).format(__param[1]);return data;default:return data}}return false}array.filters={};array.addFilter=function(e,t,r){if(!this.filters.hasOwnProperty(e)){this.filters[e]=[]}var a={};a[t]=r;this.filters[e].push(a);filterCount++;return true};array.removeFilter=function(e){if(this.filters.hasOwnProperty(e)){filterCount-=this.filters[e].length;delete this.filters[e];return true}return false};array.getFilters=function(){return this.filters};array.resetFilters=function(){this.filters={};filterCount=0};array.setFilters=function(e){this.resetFilters();for(var t in e){for(var r=0;r<e[t].length;r++){for(var a in e[t][r]){array.addFilter(t,a,e[t][r][a])}}}};array.setFilteringMode=function(e){filterMode=e};array.get=function(e,t,r,a,i){if(typeof t==="undefined"){t=false}if(typeof r==="undefined"){r=false}if(typeof r==="number"){a=r;r=false}if(typeof a==="undefined"){a=0}if(typeof i==="undefined"){i=false}var s=this.getFilters();this.resetFilters();for(var f in e){for(var n in e[f]){this.addFilter(f,n,e[f][n])}}var o=this.filter(a,i);this.resetFilters();this.setFilters(s);if(i){return o}if(a===1){if(o.length){return o[0]}return false}if(t){for(var f in t){o.order(f,t[f]);break}}if(r){return o.group.apply(null,r)}return o};array.unset=function(e,t){if(typeof t==="undefined"){t=0}var r=new OGX.List;var a=this.get(e,null,null,t,true);if(a){for(var i=0;i<a.length;i++){r.push(this.delete(a[i]-r.length))}}if(t===1&&r.length){return r[0]}return r};array.filter=function(__limit,__as_position){if(typeof __limit==="undefined"){__limit=0}if(typeof __as_position==="undefined"){__as_position=false}var ar=[];var positions=[];var isDate,isString,isArray,isObject;var hasFilters=false;var reg=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}( [0-9]{2}\:[0-9]{2}\:[0-9]{2})?/g;var isMatch=false;var matches=0;var str,o,err;var counter,total;for(var i=0;i<this.length;i++){isMatch=true;matches=0;for(var a in this.filters){err=false;try{o=null;str="this["+i+"]."+a;o=eval(str)}catch(e){err=true}if(!err&&typeof o!=="undefined"){hasFilters=true;isDate=false;isString=false;isArray=Array.isArray(o);isObject=!isArray&&typeof o==="object";if(!isArray){if(typeof o==="string"){isString=true;if(o.match(reg)){isDate=true}}}else{if(typeof o[0]==="string"){isString=true;if(o[0].match(reg)){isDate=true}}}for(var j=0;j<this.filters[a].length;j++){for(var b in this.filters[a][j]){if(!String(this.filters[a][j][b]).length){matches++}else{if(b==="function"){isMatch=this.filters[a][j][b](o);if(isMatch){matches++}}else{switch(b){case"eq":if(isDate){if(moment(o).format("YYYY-MM-DD")!==moment(this.filters[a][j][b]).format("YYYY-MM-DD")){isMatch=false}else{matches++}}else{if(isString){if(o.toLowerCase()!==String(this.filters[a][j][b]).toLowerCase()){isMatch=false}else{matches++}}else{if(o!==this.filters[a][j][b]){isMatch=false}else{matches++}}}break;case"eqjson":if(JSON.stringify(o)!==JSON.stringify(this.filters[a][j][b])){isMatch=false}else{matches++}break;case"neq":if(isDate){if(moment(o).format("YYYY-MM-DD")===moment(this.filters[a][j][b]).format("YYYY-MM-DD")){isMatch=false}else{matches++}}else{if(isString){if(o.toLowerCase()===this.filters[a][j][b].toLowerCase()){isMatch=false}else{matches++}}else{if(o===this.filters[a][j][b]){isMatch=false}else{matches++}}}break;case"in":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++){if(o.indexOf(this.filters[a][j][b][k])===-1){isMatch=false;break}}if(isMatch){matches++}}else{if(isString){if(isArray){if(o.indexOf(this.filters[a][j][b])===-1){isMatch=false}else{matches++}}else{if(o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())===-1){isMatch=false}else{matches++}}}else{if(isArray){if(o.indexOf(this.filters[a][j][b])===-1){isMatch=false}else{matches++}}else{if(isObject){counter=0;total=0;for(var p in this.filters[a][j][b]){total++;if(o.hasOwnProperty(p)&&String(o[p]).toLocaleLowerCase().indexOf(String(this.filters[a][j][b][p]).toLowerCase())!==-1){counter++}}isMatch=total===counter;if(isMatch){matches++}}}}}break;case"nin":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++){if(o.indexOf(this.filters[a][j][b][k])!==-1){isMatch=false;break}}if(isMatch){matches++}}else{if(isString){if(o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())!==-1){isMatch=false}else{matches++}}else{if(o.indexOf(this.filters[a][j][b])!==-1){isMatch=false}else{matches++}}}break;case"gt":if(isDate){if(moment(o).unix()<=moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o<=this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"gte":if(isDate){if(moment(o).unix()<moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o<this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"lt":if(isDate){if(moment(o).unix()>=moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o>=this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"lte":if(isDate){if(moment(o).unix()>moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o>this.filters[a][j][b]){isMatch=true}else{matches++}}break;case"btw":if(isDate){if(moment(this.filters[a][j][b][0]).unix()>moment(o).unix()||moment(this.filters[a][j][b][1]).unix()<moment(o).unix()){isMatch=false}else{matches++}}else{if(this.filters[a][j][b][0]>o||this.filters[a][j][b][1]<o){isMatch=false}else{matches++}}break;case"substr":if(o.toLowerCase().substr(this.filters[a][j][b][0],this.filters[a][j][b][1]).toLowerCase()!==this.filters[a][j][b][2].toLowerCase()){isMatch=false}else{matches++}break;case"regex":if(!o.toString().match(this.filters[a][j][b])){isMatch=false}else{matches++}break}}}if(!isMatch){break}}}}else{isMatch=false}if(filteringMode==="or"){if(isMatch){ar.push(this[i]);positions.push(i)}}else{if(matches===filterCount){ar.push(this[i]);positions.push(i)}}if(__limit&&ar.length===__limit){if(__as_position){return positions}return OGX.List.apply(null,ar)}}}if(__as_position){return positions}if(hasFilters){return OGX.List.apply(null,ar)}return array};return array};