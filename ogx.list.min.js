/* globules.io OGX.List v1.2.4 */
if(typeof OGX==="undefined"){var OGX={}}OGX.List=function(){if(typeof moment==="undefined"){console.log("%c CRITICAL ERROR - moment.js not found! ","background:#222; color: #FF0000");return}var filteringMode="and";var filterCount=0;var indexes=false;if(arguments.length===1&&arguments[0]instanceof Array){arguments=arguments[0]}var array=Object.create(Array.prototype);array=Array.apply(array,arguments)||array;for(var method in OGX.List.prototype){if(OGX.List.prototype.hasOwnProperty(method)){array[method]=OGX.List.prototype[method]}}array.insert=function(e,t){if(typeof t==="undefined"){array.push(e)}else{array.splice(t,0,e)}if(indexes){addToCache(e)}return true};array.delete=function(e){var t=this;var r=array.splice(e,1);if(r.length){if(indexes){var i=matchesCache(r[0]);if(i){setTimeout(function(){t.rebuild(i)},0)}}return r[0]}return false};array.last=function(){if(this.length){return this[this.length-1]}return};array.findDelete=function(e,t,r){var i=0;if(typeof r==="undefined"){r=0}var s=new OGX.List;for(var a=0;a<this.length;a++){if(this[a][e]===t){s.push(this.splice(a,1)[0]);if(indexes){var f=matchesCache(s.last());if(f){this.rebuild(f)}}i++;if(r>0&&r===i){if(r===1){return s[0]}else{return s}}a--}}return s};array.findReplace=function(e,t,r,i){var s=0;if(typeof i==="undefined"){i=0}var a=new OGX.List;for(var f=0;f<this.length;f++){if(this[f][e]===t){a.push(this[f]);s++;this[f]=r;if(i>0&&i===s){if(i===1){return a[0]}else{return a}}}}if(!a.length){return false}else{return a}};array.findUpdate=function(e,t,r,i,s){var a=0;if(typeof i==="undefined"){i=false}if(typeof s==="undefined"){s=0}var f=new OGX.List;var n;for(var o=0;o<this.length;o++){if(this[o][e]===t){n=false;for(var l in r){if(i){if(this[o].hasOwnProperty(l)){this[o][l]=r[l];n=true;a++}}else{this[o][l]=r[l];n=true;a++}}if(n){f.push(this[o]);if(s>0&&s===a){if(s===1){return f[0]}else{return f}}}}}if(!f.length){return false}else{return f}};array.findIndex=function(e,t){var r=false;if(t instanceof RegExp){r=true}for(var i=0;i<this.length;i++){if(r){if(this[i][e].match(t)){return{index:i}}}else{if(this[i][e]===t){return{index:i}}}}return false};array.find=function(e,t,r){var i=0;var s=new OGX.List;var a=false;if(t instanceof RegExp){a=true}if(typeof r==="undefined"){r=0}for(var f=0;f<this.length;f++){if(a){if(this[f][e].match(t)){s.push(this[f]);i++}}else{if(this[f][e]===t){s.push(this[f]);i++}}if(r>0&&i===r){if(r===1){return s[0]}else{return s}}}if(!s.length){return false}else{return s}};array.swap=function(e,t){var r=this[e];this[e]=this[t];this[t]=r};array.cache=function(){if(!indexes){indexes={}}var e=[];var t=[];var r;if(arguments.length>1){for(var i=0;i<arguments.length;i++){e.push(arguments[i])}e=e.join("|")}else{e=e}if(!indexes.hasOwnProperty(e)){indexes[e]={}}for(var s=0;s<this.length;s++){t=[];for(var i=0;i<arguments.length;i++){t.push(this[s][arguments[i]])}t=t.join("|");if(!indexes[e].hasOwnProperty(t)){indexes[e][t]=[]}indexes[e][t].push(this[s])}return true};array.uncache=function(e){if(!indexes){return false}var t=e;if(arguments.length>1){t=arguments.join("|")}if(indexes.hasOwnProperty(t)){delete indexes[t];return true}return false};function addToCache(e){var t;for(var r in indexes){if(r.indexOf("|")!==-1){r=r.split("|");t=[];for(var i=0;i<r.length;i++){if(e.hasOwnProperty(r[i])){t.push(e[r[i]])}}t=t.join("|");r=r.join("|")}else{if(e.hasOwnProperty(r)){t=e[r]}}if(!indexes.hasOwnProperty(r)){indexes[r]={}}indexes[r][t]=e}}array.rebuild=function(e){for(var t=0;t<e.length;t++){delete indexes[e[t]];this.cache(e[t])}};function matchesCache(e){var t=[];var r=[];var i;for(var s in indexes){i=true;if(s.indexOf("|")!==-1){t=s.split("|")}else{t=[s]}for(var a=0;a<t.length;a++){if(!e.hasOwnProperty(t[a])){i=false;break}}if(i){r.push(s)}}if(r.length){return r}return false}array.read=function(e,t,r){var i=arguments;if(!indexes){return false}if(!i.length){return indexes}var s,a;if(typeof e==="object"){r=i[1];s=[];a=[];for(var f in e){s.push(f);a.push(e[f])}s=s.join("|");a=a.join("|")}else{s=e;a=t}if(typeof r==="undefined"){r=0}if(indexes.hasOwnProperty(s)&&indexes[s].hasOwnProperty(a)){if(r){if(r>1){return indexes[s][a].splice(0,r)}else{return indexes[s][a][0]}}return indexes[s][a]}return false};array.clear=function(){indexes=false;filterCount=0;this.length=0};array.unique=function(e,t,r){if(typeof t==="undefined"){t=true}if(typeof r==="undefined"){r=[e]}else{if(!Array.isArray(r)){r=[r]}}var i={};i[e]={regex:/(.){1,}/};var s=this.get();var a=[];var f=new OGX.List;var n;for(var o=0;o<s.length;o++){if(a.indexOf(s[o][e])===-1){a.push(s[o][e]);if(t){n={};for(var l=0;l<r.length;l++){n[r[l]]=s[o][e]}f.push(n)}}}if(t){return f}return a};array.order=function(e,t){array.sort(dynamicSort(e,t))};function dynamicSort(r,i){return function(e,t){return e[r]<t[r]?i*-1:e[r]>t[r]?i:0}}array.group=function(e,t,r){if(Array.isArray(e)){return array.groupm(e,t,r)}var i;var s={};for(var a=0;a<this.length;a++){i=extract(this[a],e,t,r);if(i){if(!s.hasOwnProperty(i)){s[i]=new OGX.List}s[i].push(this[a])}}return s};array.groupm=function(n,o,l){function h(e,t){var r=new OGX.List(e);var i=o;var s=l;if(typeof o!=="undefined"){Array.isArray(o)?i=o[t]:null}if(typeof l!=="undefined"){Array.isArray(l)?s=l[t]:null}var a=r.group(n[t],i,s);if(t+1<=n.length-1){for(var f in a){a[f]=h(a[f],t+1)}}return a}var e=h(this,0);return e};function extract(e,t,r,i){if(e.hasOwnProperty(t)){var s=e[t];switch(r){case"substr":s=s.substr(i[0],i[1]);return s;case"numrange":s=Number(s);if(!Array.isArray(i)){s=Math.floor(s/i);s=s*i+" - "+(s+1)*i}else{s=Math.floor(s/i[0]);if(i[2]==="pre"){s=i[1]+s*i[0]+" - "+i[1]+(s+1)*i[0]}else{s=s*i[0]+i[1]+" - "+(s+1)*i[0]+i[1]}}return s;case"date":if(!Array.isArray(i)){if(i==="year"){s=s.substr(0,4);return s}else{if(i==="month"){s=s.substr(0,7);return s}else{if(i==="week"){s=s.substr(0,4)+" week "+moment(s).week();return s}}}}s=moment(s).unix();s=Math.floor(s/(i[0]*60*60*24));s=s*(i[0]*60*60*24);s=moment(s*1e3).format(i[1])+" - "+moment(s*1e3+i[0]*1e3*60*60*24).format(i[1]);return s;default:return s}}return false}array.filters={};array.addFilter=function(e,t,r){if(!this.filters.hasOwnProperty(e)){this.filters[e]=[]}var i={};i[t]=r;this.filters[e].push(i);filterCount++;return true};array.removeFilter=function(e){if(this.filters.hasOwnProperty(e)){filterCount-=this.filters[e].length;delete this.filters[e];return true}return false};array.getFilters=function(){return this.filters};array.resetFilters=function(){this.filters={};filterCount=0};array.setFilters=function(e){this.resetFilters();for(var t in e){for(var r=0;r<e[t].length;r++){for(var i in e[t][r]){array.addFilter(t,i,e[t][r][i])}}}};array.setFilteringMode=function(e){filterMode=e};array.get=function(e,t,r,i,s){if(typeof t==="undefined"){t=false}if(typeof r==="undefined"){r=false}if(typeof r==="number"){i=r;r=false}if(typeof i==="undefined"){i=0}if(typeof s==="undefined"){s=false}var a=this.getFilters();this.resetFilters();for(var f in e){for(var n in e[f]){this.addFilter(f,n,e[f][n])}}var o=this.filter(i,s);this.resetFilters();this.setFilters(a);if(s){return o}if(i===1){if(o.length){return o[0]}return false}if(t){for(var f in t){o.order(f,t[f]);break}}if(r){return o.group.apply(null,r)}return o};array.unset=function(e,t){if(typeof t==="undefined"){t=0}var r=new OGX.List;var i=this.get(e,null,null,t,true);if(i){for(var s=0;s<i.length;s++){r.push(this.delete(i[s]-r.length))}}if(t===1&&r.length){return r[0]}return r};array.filter=function(__limit,__as_position){if(typeof __limit==="undefined"){__limit=0}if(typeof __as_position==="undefined"){__as_position=false}var ar=[];var positions=[];var isDate,isString,isArray,isObject;var hasFilters=false;var reg=/[0-9]{4}\-[0-9]{2}\-[0-9]{2}( [0-9]{2}\:[0-9]{2}\:[0-9]{2})?/g;var isMatch=false;var matches=0;var str,o,err;var counter,total;for(var i=0;i<this.length;i++){isMatch=true;matches=0;for(var a in this.filters){err=false;try{o=null;str="this["+i+"]."+a;o=eval(str)}catch(e){err=true}if(!err&&typeof o!=="undefined"){hasFilters=true;isDate=false;isString=false;isArray=Array.isArray(o);isObject=!isArray&&typeof o==="object";if(!isArray){if(typeof o==="string"){isString=true;if(o.match(reg)){isDate=true}}}else{if(typeof o[0]==="string"){isString=true;if(o[0].match(reg)){isDate=true}}}for(var j=0;j<this.filters[a].length;j++){for(var b in this.filters[a][j]){if(!String(this.filters[a][j][b]).length){matches++}else{if(b==="function"){isMatch=this.filters[a][j][b](o);if(isMatch){matches++}}else{switch(b){case"eq":if(isDate){if(moment(o).format("YYYY-MM-DD")!==moment(this.filters[a][j][b]).format("YYYY-MM-DD")){isMatch=false}else{matches++}}else{if(isString){if(o.toLowerCase()!==String(this.filters[a][j][b]).toLowerCase()){isMatch=false}else{matches++}}else{if(o!==this.filters[a][j][b]){isMatch=false}else{matches++}}}break;case"eqjson":if(JSON.stringify(o)!==JSON.stringify(this.filters[a][j][b])){isMatch=false}else{matches++}break;case"neq":if(isDate){if(moment(o).format("YYYY-MM-DD")===moment(this.filters[a][j][b]).format("YYYY-MM-DD")){isMatch=false}else{matches++}}else{if(isString){if(o.toLowerCase()===this.filters[a][j][b].toLowerCase()){isMatch=false}else{matches++}}else{if(o===this.filters[a][j][b]){isMatch=false}else{matches++}}}break;case"in":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++){if(o.indexOf(this.filters[a][j][b][k])===-1){isMatch=false;break}}if(isMatch){matches++}}else{if(isString){if(isArray){if(o.indexOf(this.filters[a][j][b])===-1){isMatch=false}else{matches++}}else{if(o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())===-1){isMatch=false}else{matches++}}}else{if(isArray){if(o.indexOf(this.filters[a][j][b])===-1){isMatch=false}else{matches++}}else{if(isObject){counter=0;total=0;for(var p in this.filters[a][j][b]){total++;if(o.hasOwnProperty(p)&&String(this.filters[a][j][b][p]).toLowerCase()==String(o[p]).toLocaleLowerCase()){counter++}}isMatch=total===counter;if(isMatch){matches++}}}}}break;case"nin":if(Array.isArray(this.filters[a][j][b])){for(var k=0;k<this.filters[a][j][b].length;k++){if(o.indexOf(this.filters[a][j][b][k])!==-1){isMatch=false;break}}if(isMatch){matches++}}else{if(isString){if(o.toLowerCase().indexOf(this.filters[a][j][b].toLowerCase())!==-1){isMatch=false}else{matches++}}else{if(o.indexOf(this.filters[a][j][b])!==-1){isMatch=false}else{matches++}}}break;case"gt":if(isDate){if(moment(o).unix()<=moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o<=this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"gte":if(isDate){if(moment(o).unix()<moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o<this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"lt":if(isDate){if(moment(o).unix()>=moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o>=this.filters[a][j][b]){isMatch=false}else{matches++}}break;case"lte":if(isDate){if(moment(o).unix()>moment(this.filters[a][j][b]).unix()){isMatch=false}else{matches++}}else{if(o>this.filters[a][j][b]){isMatch=true}else{matches++}}break;case"btw":if(isDate){if(moment(this.filters[a][j][b][0]).unix()>moment(o).unix()||moment(this.filters[a][j][b][1]).unix()<moment(o).unix()){isMatch=false}else{matches++}}else{if(this.filters[a][j][b][0]>o||this.filters[a][j][b][1]<o){isMatch=false}else{matches++}}break;case"substr":if(o.toLowerCase().substr(this.filters[a][j][b][0],this.filters[a][j][b][1]).toLowerCase()!==this.filters[a][j][b][2].toLowerCase()){isMatch=false}else{matches++}break;case"regex":if(!o.toString().match(this.filters[a][j][b])){isMatch=false}else{matches++}break}}}if(!isMatch){break}}}}else{isMatch=false}if(filteringMode==="or"){if(isMatch){ar.push(this[i]);positions.push(i)}}else{if(matches===filterCount){ar.push(this[i]);positions.push(i)}}if(__limit&&ar.length===__limit){if(__as_position){return positions}return OGX.List.apply(null,ar)}}}if(__as_position){return positions}if(hasFilters){return OGX.List.apply(null,ar)}return array};return array};